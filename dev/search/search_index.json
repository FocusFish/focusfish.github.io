{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"UVMS documentation","text":"<p>UMVS is an open source Vessel monitoring system.</p>"},{"location":"configuration/","title":"Configuration","text":"<p>An out-of-the-box UVMS installation is configured to work in a test environment. Each module has a corresponding tab under <code>Admin-&gt;Configuration</code>, with the exception of exchange plugins which have their configuration under the exchange tab. To configure <code>UVMS</code>:</p> <ol> <li>Open <code>&lt;HOST&gt;:28080/unionvms/#/admin/configuration</code>.</li> <li>Click on the tab corresponding to the module that is to be configured.</li> <li>Click the <code>edit</code>-button (pen icon).</li> <li>Change the value (inline in the table).</li> <li>Click the <code>check mark</code>-button to save the changes.</li> </ol>"},{"location":"installation/","title":"Installation","text":"<p>There are two ways to install UVMS; Manually or through Docker. UVMS has only ever been deployed in production running directly on a host, thus the Docker way is considered experimental and is not recommended for production use as of yet.</p>"},{"location":"installation/docker/","title":"Docker","text":"<p>Warning</p> <p>The Docker based setup is not recommended for production use</p> <p>There are two ways to test a Docker based setup; docker-compose and Maven fabric8 Docker plugin. The latter is intended for development usage, but can be an option if there's a strong preference for building the images from scratch.</p> <p>After installation the following will be running. (Volumes are not strictly necessary, see Ephemeral tip)</p> <pre><code>architecture-beta\n    group host(server)[Host]\n    group docker(cloud)[Docker] in host\n\n    group wf(cloud)[Wildfly container] in docker\n    service wildfly(server)[Wildfly] in wf\n\n    group postgres(cloud)[PostgreSQL container] in docker\n    service db(database)[Database] in postgres\n\n    db:L -- R:wildfly\n    service disk2(disk)[Volume] in host\n    disk2:T -- B:wildfly\n    service disk1(disk)[Volume] in host\n    disk1:T -- B:db</code></pre> <p>With the exception of JMS for the <code>docker-compose</code> option, the following table of port mappings apply:</p> Service What Port (host:container) Wildfly Management GUI 29990:9990 HTTP 28080:8080 HTTPS 28443:8443 JMS 5445:5445 JMS 5455:5455 PostgreSQL 25432:5432"},{"location":"installation/docker/#docker-compose","title":"Docker-compose","text":"<p>Prerequisites</p> <ul> <li>Docker installed</li> <li>docker-compose installed</li> </ul>"},{"location":"installation/docker/#install","title":"Install","text":"Ephemeral mode <p>To run in an \"ephemeral\" mode the <code>volumes</code> part in <code>docker-compose-4.7.0.yml</code> can be removed.</p> <pre><code>11,13d10\n&lt;     volumes:\n&lt;       - /app/logs:/app/logs\n&lt;       - /opt/jboss/wildfly/standalone/log:/opt/jboss/wildfly/standalone/log\n</code></pre> Download and start UVMS stack through docker-compose<pre><code>wget https://repo1.maven.org/maven2/fish/focus/uvms/docker/docker-compose/4.7.0/docker-compose-4.7.0.yml\ndocker-compose -f ./docker-compose-4.7.0.yml up -d # (1)\n</code></pre> <ol> <li><code>-f</code> flag points to the yaml file downloaded in the step above. <code>-d</code> for    detach mode, i.e. the containers will continue running in the background.</li> </ol> <p>Wait for the Docker images to be downloaded and the containers then to start up and finally for Wildfly to load and start all of the UVMS modules.</p> <ol> <li> <p>Run     <pre><code>docker-compose -f ./docker-compose-4.7.0.yml logs -f\n</code></pre></p> <p>Look for something similar to <code>WildFly Full 26.0.0.Final (WildFly Core 18.0.0.Final) started in 12345ms</code> in the logs</p> </li> <li> <p>Access the GUI at http://localhost:28080,    credentials: <code>vms_admin_com</code>/<code>password</code></p> </li> </ol> <p>Warning</p> <p>Using <code>docker-compose up</code> always starts the system from a clean slate. This means that any data in the database is lost if the command is used after the first start.</p> <p>Use <code>docker-compose stop</code> and <code>docker-compose start</code> to stop and start an already running system</p>"},{"location":"installation/docker/#stop-and-clean-up","title":"Stop and clean up","text":"<p>Once done the UVMS stack can be cleaned up with:</p> Clean up UVMS stack<pre><code>docker-compose -f ./docker-compose-4.7.0.yml down --volumes # (1)\n</code></pre> <ol> <li>By default, named volumes in your compose file are not removed when you run    <code>docker-compose down</code>. If you want to remove the volumes, you need to add the    <code>--volumes</code> flag.</li> </ol>"},{"location":"installation/docker/#build-uvms-images-from-the-umvs-docker-repo","title":"Build UVMS images from the UMVS-Docker repo","text":"<p>Prerequisites</p> <ul> <li>Docker installed</li> <li>Java 11</li> <li>Maven</li> </ul>"},{"location":"installation/docker/#install_1","title":"Install","text":"<ol> <li><code>git</code> clone repo: UVMS-Docker</li> <li>Then run     Build all Docker images and start an empty UVMS instance<pre><code>cd UVMS-Docker \\\n&amp;&amp; mvn clean install -Pdocker -DskipITs \\\n&amp;&amp; cd unionvms-test \\\n&amp;&amp; mvn docker:start \\\n&amp;&amp; cd ..\n</code></pre></li> <li>With a <code>BUILD SUCCESS</code> from the above step the Docker containers should now    be up and running. Verify with: <code>docker ps</code></li> <li>Access the GUI at http://localhost:28080,    credentials: <code>vms_admin_com</code>/<code>password</code></li> </ol>"},{"location":"installation/docker/#stop-and-clean-up_1","title":"Stop and clean up","text":"Stop Docker containers and clean up<pre><code>docker stop postgres-release-1 wildfly-unionvms-1 \\\n&amp;&amp; docker system prune -f --volumes\n</code></pre>"},{"location":"installation/manual/","title":"Manual installation","text":"<p>It is recommended to run PostgreSQL and Wildfly on different machines. This how-to is for a simple setup with one PostgreSQL server and one Wildfly server. It does not cover more advanced use cases such as backups, replication, geo-redundancy, general maintenance, etc.</p> <p>Prerequisites</p> <ul> <li>Two machines (VM or bare metal) with ssh access and sudo privileges</li> <li>Connectivity between the machines for Wildfly &lt;-&gt; PostgreSQL (5432)</li> </ul> <p>After installation the following will be running. Note that storage might be better served through a SAN instead.</p> <pre><code>architecture-beta\n    group wf(server)[Wildfly host]\n    service wildfly(server)[Wildfly] in wf\n    service disk2(disk)[Storage] in wf\n    disk2:T -- B:wildfly\n\n    group postgres(server)[PostgreSQL host]\n    service db(database)[Database] in postgres\n    service disk1(disk)[Storage] in postgres\n    disk1:T -- B:db\n\n    db:L -- R:wildfly</code></pre>"},{"location":"installation/manual/#postgresql-server","title":"PostgreSQL server","text":"<p>Versions:</p> <ul> <li><code>PostgreSQL 17</code></li> <li><code>Postgis 3.6.0</code></li> </ul> Install PostgreSQL with PostGIS extension<pre><code>sudo zypper in postgis36_17\n\n# for other OSes see: https://postgis.net/documentation/getting_started/\n</code></pre> <p>Warning</p> <p>Security setup and hardening is not part of this how-to guide. The following steps are focused on what UVMS needs, but does not e.g. set a postgres password, open ports, etc.</p> <p>With an empty PostgreSQL it's now time to add a new database and the needed schemas and users.</p> <ol> <li>Download setup.sql</li> <li>Change <code>db71u</code> to a name of your choosing. Make sure to replace all of the occurrences</li> <li>Change all passwords for the tables (<code>WITH PASSWORD 'XYZ'</code>)</li> <li>Run the SQL script (with <code>psql</code> or a GUI such as <code>pgadmin</code>, <code>dbeaver</code>, etc).</li> </ol>"},{"location":"installation/manual/#wildfly-server","title":"Wildfly server","text":""},{"location":"installation/manual/#basic-server-setup","title":"Basic server setup","text":"<p>UVMS requires Java 11 and has not been tested on newer versions.</p> <p>On a SLES setup run:</p> <pre><code># Install Java 11\nsudo zypper install java-11-openjdk-devel\n\n# Add a wildfly user\nsudo /usr/sbin/groupadd -r wildfly\nsudo /usr/sbin/useradd -r -g wildfly -d /opt/wildfly -s /sbin/nologin wildfly\n\n# Create folder structure\nsudo mkdir -p /opt/wildfly\nsudo chown -R wildfly:users /opt/wildfly\nsudo mkdir -p /opt/uvms/app/logs\nsudo chown -R wildfly:users /opt/uvms\nsudo ln -s /opt/uvms/app /app\n\n# Open firewall\nsudo firewall-cmd --zone=public --add-port=28080/tcp --permanent\nsudo firewall-cmd --zone=public --add-port=5445/tcp --permanent\nsudo firewall-cmd --zone=public --add-port=8443/tcp --permanent\nsudo firewall-cmd --zone=public --add-port=9990/tcp --permanent\nsudo firewall-cmd --reload\n\n# 28080 - wildfly http\n# 5445 - jms / activemq\n# 8443 - wildfly https\n# 9990 - wildfly mgmt console\n\n# Verify with\nsudo firewall-cmd --list-all\n</code></pre>"},{"location":"installation/manual/#wildfly-setup","title":"Wildfly setup","text":"<p>Add default configuration and a <code>systemd</code> service for Wildfly.</p> Add wildfly conf<pre><code>sudo tee -a /etc/default/wildfly.conf &lt;&lt; 'EOF'\n# The configuration you want to run\nWILDFLY_CONFIG=standalone-full.xml\n\n# The mode you want to run\nWILDFLY_MODE=standalone\n\n# The address to bind to\nWILDFLY_BIND=0.0.0.0\nEOF\n</code></pre> Add launch script<pre><code>sudo -u wildfly tee -a /opt/wildfly/launch.sh &lt;&lt; 'EOF'\n#!/bin/sh\nif [ \"x$WILDFLY_HOME\" = \"x\" ]; then\n    WILDFLY_HOME=\"/opt/wildfly/current\"\nfi\n\nif [[ \"$1\" == \"domain\" ]]; then\n    $WILDFLY_HOME/bin/domain.sh -c $2 -b $3 -bmanagement $3\nelse\n    $WILDFLY_HOME/bin/standalone.sh -c $2 -b $3 -bmanagement $3\nfi\nEOF\n</code></pre> Make it executable<pre><code>sudo chmod +x /opt/wildfly/launch.sh\n</code></pre> Add systemd service for wildfly<pre><code>sudo tee -a /etc/systemd/system/wildfly.service &lt;&lt; 'EOF'\n[Unit]\nDescription=The WildFly Application Server\nAfter=syslog.target network.target\n\n[Service]\nEnvironment=LAUNCH_JBOSS_IN_BACKGROUND=1\nEnvironmentFile=-/etc/default/wildfly.conf\nUser=wildfly\nLimitNOFILE=102642\nPIDFile=/var/run/wildfly/wildfly.pid\nExecStart=/opt/wildfly/launch.sh $WILDFLY_MODE $WILDFLY_CONFIG $WILDFLY_BIND\nStandardOutput=null\n\n[Install]\nWantedBy=multi-user.target\nEOF\n</code></pre> Enable the service<pre><code>sudo systemctl enable wildfly\nsudo systemctl daemon-reload\n</code></pre>"},{"location":"installation/manual/#install-uvms-components","title":"Install UVMS components","text":"<p>Prerequisites</p> <ul> <li>Basic server setup completed</li> <li>Wildfly setup completed</li> <li>SSH user with <code>sudo</code> privileges (not the <code>wildfly</code> user as it should not   have <code>sudo</code> nor login privileges)</li> </ul>"},{"location":"installation/manual/#files","title":"Files","text":"<p>The following <code>pom.xml</code> utilizes SSH and SCP through the maven-antrun-plugin for maven to move artifacts and run commands on a target host.</p> <p>Copy the contents of the three files <code>pom.xml</code>, <code>assembly.xml</code>, and <code>uvms.properties</code> into a folder structure like the following:</p> Folder structure<pre><code>.\n\u251c\u2500\u2500 src\n\u2502   \u2514\u2500\u2500 main\n\u2502       \u251c\u2500\u2500 assembly\n\u2502       \u2502   \u2514\u2500\u2500 assembly.xml\n\u2502       \u2514\u2500\u2500 wf-scripts\n\u2502           \u2514\u2500\u2500 uvms.properties\n\u2514\u2500\u2500 pom.xml\n</code></pre> <p>Warning</p> <p>The <code>pom.xml</code> file contains a number of properties that needs setting (look for <code>SET_ME</code>). Some of them are set in the next section through environment variables, and is labeled as <code>OPTIONAL_SET_ME</code> instead. For example <code>scp.target.server.hostname</code> is one that is mandatory to set in <code>pom.xml</code>.</p> pom.xml<pre><code>&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0\n                      http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;groupId&gt;se.havochvatten.unionvms&lt;/groupId&gt;\n    &lt;artifactId&gt;wildfly-dist&lt;/artifactId&gt;\n    &lt;version&gt;${unionvms.docker.version}&lt;/version&gt;\n    &lt;packaging&gt;pom&lt;/packaging&gt;\n\n    &lt;properties&gt;\n        &lt;unionvms.wildfly.version&gt;26.0.0.Final&lt;/unionvms.wildfly.version&gt;\n        &lt;unionvms.docker.version&gt;4.6.4&lt;/unionvms.docker.version&gt;\n        &lt;unionvms.activemq-rar.version&gt;5.16.3&lt;/unionvms.activemq-rar.version&gt;\n    &lt;/properties&gt;\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.wildfly&lt;/groupId&gt;\n            &lt;artifactId&gt;wildfly-dist&lt;/artifactId&gt;\n            &lt;version&gt;${unionvms.wildfly.version}&lt;/version&gt;\n            &lt;type&gt;zip&lt;/type&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;fish.focus.uvms.docker&lt;/groupId&gt;\n            &lt;artifactId&gt;uvms-docker-postgres-release&lt;/artifactId&gt;\n            &lt;version&gt;${unionvms.docker.version}&lt;/version&gt;\n            &lt;type&gt;zip&lt;/type&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;com.oracle&lt;/groupId&gt;\n                    &lt;artifactId&gt;ojdbc6&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;fish.focus.uvms.docker&lt;/groupId&gt;\n            &lt;artifactId&gt;uvms-docker-wildfly-base&lt;/artifactId&gt;\n            &lt;version&gt;${unionvms.docker.version}&lt;/version&gt;\n            &lt;type&gt;zip&lt;/type&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n                    &lt;artifactId&gt;hibernate-spatial&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.postgis&lt;/groupId&gt;\n                    &lt;artifactId&gt;postgis-jdbc&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;fish.focus.uvms.docker&lt;/groupId&gt;\n            &lt;artifactId&gt;uvms-docker-wildfly-unionvms&lt;/artifactId&gt;\n            &lt;version&gt;${unionvms.docker.version}&lt;/version&gt;\n            &lt;type&gt;zip&lt;/type&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n    &lt;build&gt;\n        &lt;pluginManagement&gt;\n            &lt;plugins&gt;\n                &lt;plugin&gt;\n                    &lt;artifactId&gt;maven-antrun-plugin&lt;/artifactId&gt;\n                    &lt;version&gt;1.8&lt;/version&gt;\n                    &lt;dependencies&gt;\n                        &lt;dependency&gt;\n                            &lt;groupId&gt;org.apache.ant&lt;/groupId&gt;\n                            &lt;artifactId&gt;ant-jsch&lt;/artifactId&gt;\n                            &lt;version&gt;1.10.1&lt;/version&gt;\n                        &lt;/dependency&gt;\n                        &lt;dependency&gt;\n                            &lt;groupId&gt;com.jcraft&lt;/groupId&gt;\n                            &lt;artifactId&gt;jsch&lt;/artifactId&gt;\n                            &lt;version&gt;0.1.54&lt;/version&gt;\n                        &lt;/dependency&gt;\n                        &lt;dependency&gt;\n                            &lt;groupId&gt;ant-contrib&lt;/groupId&gt;\n                            &lt;artifactId&gt;ant-contrib&lt;/artifactId&gt;\n                            &lt;version&gt;1.0b3&lt;/version&gt;\n                            &lt;exclusions&gt;\n                                &lt;exclusion&gt;\n                                    &lt;groupId&gt;ant&lt;/groupId&gt;\n                                    &lt;artifactId&gt;ant&lt;/artifactId&gt;\n                                &lt;/exclusion&gt;\n                            &lt;/exclusions&gt;\n                        &lt;/dependency&gt;\n                    &lt;/dependencies&gt;\n                &lt;/plugin&gt;\n                &lt;plugin&gt;\n                    &lt;groupId&gt;org.liquibase&lt;/groupId&gt;\n                    &lt;artifactId&gt;liquibase-maven-plugin&lt;/artifactId&gt;\n                    &lt;version&gt;3.7.0&lt;/version&gt;\n                    &lt;configuration&gt;\n                        &lt;url&gt;jdbc:postgresql://${unionvms.database.host}:5432/${unionvms.database.name}&lt;/url&gt;\n                        &lt;tag&gt;${unionvms.docker.version}&lt;/tag&gt;\n                        &lt;promptOnNonLocalDatabase&gt;false&lt;/promptOnNonLocalDatabase&gt;\n                    &lt;/configuration&gt;\n                    &lt;dependencies&gt;\n                        &lt;dependency&gt;\n                            &lt;groupId&gt;org.postgresql&lt;/groupId&gt;\n                            &lt;artifactId&gt;postgresql&lt;/artifactId&gt;\n                            &lt;version&gt;42.3.9&lt;/version&gt;\n                        &lt;/dependency&gt;\n                    &lt;/dependencies&gt;\n                &lt;/plugin&gt;\n            &lt;/plugins&gt;\n        &lt;/pluginManagement&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.0.1&lt;/version&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;id&gt;unpack-dependencies&lt;/id&gt;\n                        &lt;phase&gt;generate-resources&lt;/phase&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;unpack-dependencies&lt;/goal&gt;\n                        &lt;/goals&gt;\n                        &lt;configuration&gt;\n                            &lt;copyPom&gt;false&lt;/copyPom&gt;\n                            &lt;outputDirectory&gt;${project.basedir}/target/content&lt;/outputDirectory&gt;\n                            &lt;excludeTypes&gt;pom&lt;/excludeTypes&gt;\n                            &lt;prependGroupId&gt;false&lt;/prependGroupId&gt;\n                            &lt;excludeTransitive&gt;true&lt;/excludeTransitive&gt;\n                        &lt;/configuration&gt;\n                    &lt;/execution&gt;\n                    &lt;execution&gt;\n                        &lt;id&gt;copy-ears&lt;/id&gt;\n                        &lt;phase&gt;generate-resources&lt;/phase&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;copy&lt;/goal&gt;\n                        &lt;/goals&gt;\n                        &lt;configuration&gt;\n                            &lt;artifactItems&gt;\n                                &lt;artifactItem&gt;\n                                    &lt;groupId&gt;org.apache.activemq&lt;/groupId&gt;\n                                    &lt;artifactId&gt;activemq-rar&lt;/artifactId&gt;\n                                    &lt;type&gt;rar&lt;/type&gt;\n                                    &lt;version&gt;${unionvms.activemq-rar.version}&lt;/version&gt;\n                                    &lt;overWrite&gt;false&lt;/overWrite&gt;\n                                    &lt;outputDirectory&gt;${project.build.directory}/addons/&lt;/outputDirectory&gt;\n                                &lt;/artifactItem&gt;\n                            &lt;/artifactItems&gt;\n                            &lt;overWriteReleases&gt;false&lt;/overWriteReleases&gt;\n                            &lt;overWriteSnapshots&gt;true&lt;/overWriteSnapshots&gt;\n                        &lt;/configuration&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;artifactId&gt;maven-antrun-plugin&lt;/artifactId&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;id&gt;unpack-liquibase&lt;/id&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;run&lt;/goal&gt;\n                        &lt;/goals&gt;\n                        &lt;phase&gt;generate-resources&lt;/phase&gt;\n                        &lt;configuration&gt;\n                            &lt;tasks&gt;\n                                &lt;unzip src=\"${project.build.directory}/content/uvms-docker-postgres-release/liquibase/fish.focus.uvms.asset.liquibase.zip\"\n                                       dest=\"${project.build.directory}/liquibase/asset\"/&gt;\n                                &lt;unzip src=\"${project.build.directory}/content/uvms-docker-postgres-release/liquibase/fish.focus.uvms.audit.liquibase.zip\"\n                                       dest=\"${project.build.directory}/liquibase/audit\"/&gt;\n                                &lt;unzip src=\"${project.build.directory}/content/uvms-docker-postgres-release/liquibase/fish.focus.uvms.config.liquibase.zip\"\n                                       dest=\"${project.build.directory}/liquibase/config\"/&gt;\n                                &lt;unzip src=\"${project.build.directory}/content/uvms-docker-postgres-release/liquibase/fish.focus.uvms.exchange.liquibase.zip\"\n                                       dest=\"${project.build.directory}/liquibase/exchange\"/&gt;\n                                &lt;unzip src=\"${project.build.directory}/content/uvms-docker-postgres-release/liquibase/fish.focus.uvms.movement-rules.liquibase.zip\"\n                                       dest=\"${project.build.directory}/liquibase/movement-rules\"/&gt;\n                                &lt;unzip src=\"${project.build.directory}/content/uvms-docker-postgres-release/liquibase/fish.focus.uvms.movement.liquibase.zip\"\n                                       dest=\"${project.build.directory}/liquibase/movement\"/&gt;\n                                &lt;unzip src=\"${project.build.directory}/content/uvms-docker-postgres-release/liquibase/fish.focus.uvms.reporting.reporting-liquibase.zip\"\n                                       dest=\"${project.build.directory}/liquibase/reporting\"/&gt;\n                                &lt;unzip src=\"${project.build.directory}/content/uvms-docker-postgres-release/liquibase/fish.focus.uvms.spatial.liquibase.zip\"\n                                       dest=\"${project.build.directory}/liquibase/spatial\"/&gt;\n                                &lt;unzip src=\"${project.build.directory}/content/uvms-docker-postgres-release/liquibase/fish.focus.uvms.user.liquibase.zip\"\n                                       dest=\"${project.build.directory}/liquibase/user\"/&gt;\n                                &lt;unzip src=\"${project.build.directory}/content/uvms-docker-postgres-release/liquibase/fish.focus.uvms.incident.liquibase.zip\"\n                                       dest=\"${project.build.directory}/liquibase/incident\"/&gt;\n                                &lt;unzip src=\"${project.build.directory}/content/uvms-docker-postgres-release/liquibase/fish.focus.uvms.activity.liquibase.zip\"\n                                       dest=\"${project.build.directory}/liquibase/activity\"/&gt;\n                            &lt;/tasks&gt;\n                        &lt;/configuration&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.7.1&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;descriptors&gt;\n                        &lt;descriptor&gt;src/main/assembly/assembly.xml&lt;/descriptor&gt;\n                    &lt;/descriptors&gt;\n                    &lt;finalName&gt;${project.artifactId}-${project.version}&lt;/finalName&gt;\n                    &lt;appendAssemblyId&gt;false&lt;/appendAssemblyId&gt;\n                &lt;/configuration&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;phase&gt;package&lt;/phase&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;single&lt;/goal&gt;\n                        &lt;/goals&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-deploy-plugin&lt;/artifactId&gt;\n                &lt;version&gt;2.8.2&lt;/version&gt;\n                &lt;goals&gt;\n                    &lt;goal&gt;deploy-file&lt;/goal&gt;\n                &lt;/goals&gt;\n                &lt;configuration&gt;\n                    &lt;packaging&gt;zip&lt;/packaging&gt;\n                    &lt;generatePom&gt;true&lt;/generatePom&gt;\n                    &lt;artifactId&gt;${project.artifactId}&lt;/artifactId&gt;\n                    &lt;groupId&gt;${project.groupId}&lt;/groupId&gt;\n                    &lt;version&gt;${project.version}&lt;/version&gt;\n                    &lt;file&gt;target/${project.artifactId}-${project.version}.zip&lt;/file&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n    &lt;profiles&gt;\n        &lt;profile&gt;\n            &lt;id&gt;scp-stop-and-install-server&lt;/id&gt;\n            &lt;build&gt;\n                &lt;plugins&gt;\n                    &lt;plugin&gt;\n                        &lt;artifactId&gt;maven-antrun-plugin&lt;/artifactId&gt;\n                        &lt;executions&gt;\n                            &lt;execution&gt;\n                                &lt;id&gt;stop-scp&lt;/id&gt;\n                                &lt;phase&gt;verify&lt;/phase&gt;\n                                &lt;configuration&gt;\n                                    &lt;target&gt;\n                                        &lt;taskdef resource=\"net/sf/antcontrib/antcontrib.properties\"\n                                                 classpathref=\"maven.plugin.classpath\"/&gt;\n                                        &lt;!-- 1. stop wildfly if any--&gt;\n\n                                        &lt;sshexec host=\"${scp.target.server.hostname}\"\n                                                 username=\"${scp.target.server.username}\"\n                                                 password=\"${scp.target.server.password}\" trust=\"true\"\n                                                 failonerror=\"false\" command=\"sudo systemctl stop wildfly.service\"/&gt;\n\n                                        &lt;sshexec host=\"${scp.target.server.hostname}\"\n                                                 username=\"${scp.target.server.username}\"\n                                                 password=\"${scp.target.server.password}\" trust=\"true\"\n                                                 failonerror=\"false\"\n                                                 command=\"sudo -u wildfly rm ${unionvms.symlink.wildfly}\"/&gt;\n\n                                        &lt;sshexec host=\"${scp.target.server.hostname}\"\n                                                 username=\"${scp.target.server.username}\"\n                                                 password=\"${scp.target.server.password}\" trust=\"true\"\n                                                 failonerror=\"false\"\n                                                 command=\"sudo -u wildfly rm -rf ${unionvms.install.path}/${project.artifactId}*\"/&gt;\n\n                                        &lt;scp file=\"target/${project.artifactId}-${project.version}.zip\"\n                                             todir=\"${scp.target.server.username}:${scp.target.server.password}@${scp.target.server.hostname}:/tmp\"\n                                             trust=\"true\"/&gt;\n\n                                        &lt;sshexec host=\"${scp.target.server.hostname}\"\n                                                 username=\"${scp.target.server.username}\"\n                                                 password=\"${scp.target.server.password}\" trust=\"true\"\n                                                 command=\"sudo -u wildfly unzip /tmp/${project.artifactId}-${project.version}.zip -d ${unionvms.install.path}\"/&gt;\n                                        &lt;sshexec host=\"${scp.target.server.hostname}\"\n                                                 username=\"${scp.target.server.username}\"\n                                                 password=\"${scp.target.server.password}\" trust=\"true\"\n                                                 command=\"sudo rm /tmp/${project.artifactId}-${project.version}.zip\"/&gt;\n\n                                        &lt;sshexec host=\"${scp.target.server.hostname}\"\n                                                 username=\"${scp.target.server.username}\"\n                                                 password=\"${scp.target.server.password}\" trust=\"true\"\n                                                 command=\"sudo -u wildfly chmod a+x ${unionvms.install.path}/${project.artifactId}-${project.version}/unionvms-database-scripts/*.sh\"/&gt;\n\n                                        &lt;sshexec host=\"${scp.target.server.hostname}\"\n                                                 username=\"${scp.target.server.username}\"\n                                                 password=\"${scp.target.server.password}\" trust=\"true\"\n                                                 command=\"sudo -u wildfly sed s/db71u/${unionvms.database.name}/g &amp;lt; ${unionvms.install.path}/${project.artifactId}-${project.version}/unionvms-database-scripts/.pgpass &amp;gt; ~/.pgpass; chmod 600 ~/.pgpass\"/&gt;\n\n                                        &lt;sshexec host=\"${scp.target.server.hostname}\"\n                                                 username=\"${scp.target.server.username}\"\n                                                 password=\"${scp.target.server.password}\" trust=\"true\"\n                                                 command=\"sudo -u wildfly sed -i -r s/-Xmx[0-9]\\{4\\}m/-Xmx12288m/g ${unionvms.install.path}/${project.artifactId}-${project.version}/bin/standalone.conf\"/&gt;\n                                        &lt;sshexec host=\"${scp.target.server.hostname}\"\n                                                 username=\"${scp.target.server.username}\"\n                                                 password=\"${scp.target.server.password}\" trust=\"true\"\n                                                 command=\"sudo -u wildfly sed -i -r s/-XX:MetaspaceSize=[0-9]\\{1,4\\}[Mm]/-XX:MetaspaceSize=256m/g ${unionvms.install.path}/${project.artifactId}-${project.version}/bin/standalone.conf\"/&gt;\n                                        &lt;sshexec host=\"${scp.target.server.hostname}\"\n                                                 username=\"${scp.target.server.username}\"\n                                                 password=\"${scp.target.server.password}\" trust=\"true\"\n                                                 command=\"sudo -u wildfly sed -i -r s/-XX:MaxMetaspaceSize=[0-9]\\{1,4\\}[Mm]/-XX:MaxMetaspaceSize=2048m/g ${unionvms.install.path}/${project.artifactId}-${project.version}/bin/standalone.conf\"/&gt;\n\n                                        &lt;sshexec host=\"${scp.target.server.hostname}\"\n                                                 username=\"${scp.target.server.username}\"\n                                                 password=\"${scp.target.server.password}\" trust=\"true\"\n                                                 command=\"sudo -u wildfly ln -s ${unionvms.install.path}/${project.artifactId}-${project.version} ${unionvms.symlink.wildfly}\"/&gt;\n\n                                        &lt;sshexec host=\"${scp.target.server.hostname}\"\n                                                 username=\"${scp.target.server.username}\"\n                                                 password=\"${scp.target.server.password}\" trust=\"true\"\n                                                 command=\"sudo -u wildfly ${unionvms.symlink.wildfly}/bin/add-user.sh -u '${wildfly.mgmt.console.username}' -p '${wildfly.mgmt.console.password}'\"/&gt;\n\n                                        &lt;sshexec host=\"${scp.target.server.hostname}\"\n                                                 username=\"${scp.target.server.username}\"\n                                                 password=\"${scp.target.server.password}\" trust=\"true\"\n                                                 command=\"sudo -u wildfly ${unionvms.symlink.wildfly}/bin/jboss-cli.sh --file=${unionvms.symlink.wildfly}/cli-scripts/uvms_configuration.cli --properties=${unionvms.symlink.wildfly}/cli-scripts/uvms.properties\"/&gt;\n\n                                        &lt;sshexec host=\"${scp.target.server.hostname}\"\n                                                 username=\"${scp.target.server.username}\"\n                                                 password=\"${scp.target.server.password}\" trust=\"true\"\n                                                 command=\"sudo -u wildfly ${unionvms.symlink.wildfly}/bin/jboss-cli.sh --file=${unionvms.symlink.wildfly}/cli-scripts/uvms_datasources.cli --properties=${unionvms.symlink.wildfly}/cli-scripts/uvms.properties\"/&gt;\n\n                                        &lt;sshexec host=\"${scp.target.server.hostname}\"\n                                                 username=\"${scp.target.server.username}\"\n                                                 password=\"${scp.target.server.password}\" trust=\"true\"\n                                                 command=\"sudo -u wildfly ${unionvms.symlink.wildfly}/bin/jboss-cli.sh --file=${unionvms.symlink.wildfly}/cli-scripts/uvms_messaging.cli --properties=${unionvms.symlink.wildfly}/cli-scripts/uvms.properties\"/&gt;\n\n                                    &lt;/target&gt;\n                                &lt;/configuration&gt;\n                                &lt;goals&gt;\n                                    &lt;goal&gt;run&lt;/goal&gt;\n                                &lt;/goals&gt;\n                            &lt;/execution&gt;\n                        &lt;/executions&gt;\n                    &lt;/plugin&gt;\n                &lt;/plugins&gt;\n            &lt;/build&gt;\n        &lt;/profile&gt;\n        &lt;profile&gt;\n            &lt;id&gt;scp-start-server&lt;/id&gt;\n            &lt;build&gt;\n                &lt;plugins&gt;\n                    &lt;plugin&gt;\n                        &lt;artifactId&gt;maven-antrun-plugin&lt;/artifactId&gt;\n                        &lt;executions&gt;\n                            &lt;execution&gt;\n                                &lt;id&gt;scp-start&lt;/id&gt;\n                                &lt;phase&gt;verify&lt;/phase&gt;\n                                &lt;configuration&gt;\n                                    &lt;target&gt;\n                                        &lt;taskdef resource=\"net/sf/antcontrib/antcontrib.properties\"\n                                                 classpathref=\"maven.plugin.classpath\"/&gt;\n\n                                        &lt;sshexec host=\"${scp.target.server.hostname}\"\n                                                 username=\"${scp.target.server.username}\"\n                                                 password=\"${scp.target.server.password}\" trust=\"true\"\n                                                 command=\"sudo systemctl start wildfly.service\"/&gt;\n                                    &lt;/target&gt;\n                                &lt;/configuration&gt;\n                                &lt;goals&gt;\n                                    &lt;goal&gt;run&lt;/goal&gt;\n                                &lt;/goals&gt;\n                            &lt;/execution&gt;\n                        &lt;/executions&gt;\n                    &lt;/plugin&gt;\n                &lt;/plugins&gt;\n            &lt;/build&gt;\n        &lt;/profile&gt;\n        &lt;profile&gt;\n            &lt;id&gt;prod-server&lt;/id&gt;\n            &lt;properties&gt;\n                &lt;scp.target.server.hostname&gt;SET_ME&lt;/scp.target.server.hostname&gt;\n                &lt;scp.target.server.username&gt;OPTIONAL_SET_ME&lt;/scp.target.server.username&gt;\n                &lt;scp.target.server.password&gt;OPTIONAL_SET_ME&lt;/scp.target.server.password&gt;\n\n                &lt;unionvms.install.path&gt;/opt/wildfly&lt;/unionvms.install.path&gt;\n                &lt;unionvms.symlink.wildfly&gt;/opt/wildfly/current&lt;/unionvms.symlink.wildfly&gt;\n\n                &lt;unionvms.database.name&gt;SET_ME&lt;/unionvms.database.name&gt;\n                &lt;unionvms.database.host&gt;SET_ME&lt;/unionvms.database.host&gt;\n\n                &lt;unionvms.database.username&gt;OPTIONAL_SET_ME&lt;/unionvms.database.username&gt;\n                &lt;unionvms.database.password&gt;OPTIONAL_SET_ME&lt;/unionvms.database.password&gt;\n\n                &lt;unionvms.database.asset.password&gt;OPTIONAL_SET_ME&lt;/unionvms.database.asset.password&gt;\n                &lt;unionvms.database.audit.password&gt;OPTIONAL_SET_ME&lt;/unionvms.database.audit.password&gt;\n                &lt;unionvms.database.config.password&gt;OPTIONAL_SET_ME&lt;/unionvms.database.config.password&gt;\n                &lt;unionvms.database.movement.password&gt;OPTIONAL_SET_ME&lt;/unionvms.database.movement.password&gt;\n                &lt;unionvms.database.movement.rules.password&gt;OPTIONAL_SET_ME&lt;/unionvms.database.movement.rules.password&gt;\n                &lt;unionvms.database.exchange.password&gt;OPTIONAL_SET_ME&lt;/unionvms.database.exchange.password&gt;\n                &lt;unionvms.database.reporting.password&gt;OPTIONAL_SET_ME&lt;/unionvms.database.reporting.password&gt;\n                &lt;unionvms.database.spatial.password&gt;OPTIONAL_SET_ME&lt;/unionvms.database.spatial.password&gt;\n                &lt;unionvms.database.usm.password&gt;OPTIONAL_SET_ME&lt;/unionvms.database.usm.password&gt;\n                &lt;unionvms.database.incident.password&gt;OPTIONAL_SET_ME&lt;/unionvms.database.incident.password&gt;\n                &lt;unionvms.database.activity.password&gt;OPTIONAL_SET_ME&lt;/unionvms.database.activity.password&gt;\n\n                &lt;wildfly.mgmt.console.username&gt;admin&lt;/wildfly.mgmt.console.username&gt;\n                &lt;wildfly.mgmt.console.password&gt;OPTIONAL_SET_ME&lt;/wildfly.mgmt.console.password&gt;\n\n                &lt;unionvms.usm.secret.key&gt;OPTIONAL_SET_ME&lt;/unionvms.usm.secret.key&gt;\n            &lt;/properties&gt;\n        &lt;/profile&gt;\n    &lt;/profiles&gt;\n&lt;/project&gt;\n</code></pre> assembly.xml<pre><code>&lt;assembly&gt;\n    &lt;id&gt;unionvmswildflydist&lt;/id&gt;\n    &lt;formats&gt;\n        &lt;format&gt;zip&lt;/format&gt;\n    &lt;/formats&gt;\n    &lt;fileSets&gt;\n        &lt;fileSet&gt;\n            &lt;directory&gt;target/content/wildfly-${unionvms.wildfly.version}/&lt;/directory&gt;\n            &lt;includes&gt;\n                &lt;include&gt;**/*.*&lt;/include&gt;\n            &lt;/includes&gt;\n            &lt;excludes&gt;\n                &lt;exclude&gt;modules/system/layers/base/org/hibernate/main/*.xml\n                &lt;/exclude&gt;\n                &lt;exclude&gt;modules/system/layers/base/org/apache/activemq/artemis/**/*.xml&lt;/exclude&gt;\n                &lt;exclude&gt;modules/system/layers/base/org/apache/activemq/artemis/**/artemis-*.jar&lt;/exclude&gt;\n                &lt;exclude&gt;modules/org/postgresql/main/**/*.*&lt;/exclude&gt;\n                &lt;exclude&gt;bin/standalone.conf&lt;/exclude&gt;\n            &lt;/excludes&gt;\n            &lt;outputDirectory&gt;&lt;/outputDirectory&gt;\n        &lt;/fileSet&gt;\n        &lt;fileSet&gt;\n            &lt;directory&gt;target/content/wildfly-${unionvms.wildfly.version}/&lt;/directory&gt;\n            &lt;includes&gt;\n                &lt;include&gt;**/logging.properties&lt;/include&gt;\n            &lt;/includes&gt;\n            &lt;outputDirectory&gt;&lt;/outputDirectory&gt;\n        &lt;/fileSet&gt;\n\n        &lt;fileSet&gt;\n            &lt;directory&gt;target/content/uvms-docker-wildfly-base/&lt;/directory&gt;\n            &lt;includes&gt;\n                &lt;include&gt;*.properties&lt;/include&gt;\n                &lt;include&gt;server.keystore&lt;/include&gt;\n                &lt;include&gt;client.truststore&lt;/include&gt;\n            &lt;/includes&gt;\n            &lt;outputDirectory&gt;standalone/configuration&lt;/outputDirectory&gt;\n        &lt;/fileSet&gt;\n        &lt;fileSet&gt;\n            &lt;directory&gt;target/content/uvms-docker-wildfly-base/&lt;/directory&gt;\n            &lt;includes&gt;\n                &lt;include&gt;standalone.conf&lt;/include&gt;\n            &lt;/includes&gt;\n            &lt;outputDirectory&gt;bin&lt;/outputDirectory&gt;\n        &lt;/fileSet&gt;\n        &lt;fileSet&gt;\n            &lt;directory&gt;src/main/assembly/wildfly/bin/init.d&lt;/directory&gt;\n            &lt;includes&gt;\n                &lt;include&gt;*.sh&lt;/include&gt;\n            &lt;/includes&gt;\n            &lt;fileMode&gt;0755&lt;/fileMode&gt;\n            &lt;outputDirectory&gt;bin/init.d&lt;/outputDirectory&gt;\n        &lt;/fileSet&gt;\n        &lt;fileSet&gt;\n            &lt;directory&gt;target/content/uvms-docker-wildfly-base/cli-scripts/\n            &lt;/directory&gt;\n            &lt;includes&gt;\n                &lt;include&gt;*.*&lt;/include&gt;\n            &lt;/includes&gt;\n            &lt;outputDirectory&gt;cli-scripts&lt;/outputDirectory&gt;\n        &lt;/fileSet&gt;\n        &lt;fileSet&gt;\n            &lt;directory&gt;target/content/uvms-docker-wildfly-base/hibernate/\n            &lt;/directory&gt;\n            &lt;includes&gt;\n                &lt;include&gt;*.*&lt;/include&gt;\n            &lt;/includes&gt;\n            &lt;outputDirectory&gt;modules/system/layers/base/org/hibernate/main\n            &lt;/outputDirectory&gt;\n        &lt;/fileSet&gt;\n        &lt;fileSet&gt;\n            &lt;directory&gt;target/content/uvms-docker-wildfly-base/artemis/\n            &lt;/directory&gt;\n            &lt;includes&gt;\n                &lt;include&gt;**/*.*&lt;/include&gt;\n            &lt;/includes&gt;\n            &lt;outputDirectory&gt;modules/system/layers/base/org/apache/activemq/artemis&lt;/outputDirectory&gt;\n        &lt;/fileSet&gt;\n        &lt;fileSet&gt;\n            &lt;directory&gt;target/content/uvms-docker-wildfly-base/postgres/\n            &lt;/directory&gt;\n            &lt;includes&gt;\n                &lt;include&gt;*.*&lt;/include&gt;\n            &lt;/includes&gt;\n            &lt;outputDirectory&gt;modules/org/postgresql/main&lt;/outputDirectory&gt;\n        &lt;/fileSet&gt;\n        &lt;fileSet&gt;\n            &lt;directory&gt;target/content/uvms-docker-wildfly-unionvms/deployments/\n            &lt;/directory&gt;\n            &lt;includes&gt;\n                &lt;include&gt;*.*&lt;/include&gt;\n            &lt;/includes&gt;\n            &lt;outputDirectory&gt;standalone/deployments&lt;/outputDirectory&gt;\n        &lt;/fileSet&gt;\n        &lt;fileSet&gt;\n            &lt;directory&gt;target/addons/&lt;/directory&gt;\n            &lt;includes&gt;\n                &lt;include&gt;*.*&lt;/include&gt;\n            &lt;/includes&gt;\n            &lt;outputDirectory&gt;standalone/deployments&lt;/outputDirectory&gt;\n        &lt;/fileSet&gt;\n\n        &lt;fileSet&gt;\n            &lt;directory&gt;target/content/uvms-docker-postgres-release/&lt;/directory&gt;\n            &lt;includes&gt;\n                &lt;include&gt;**/*.*&lt;/include&gt;\n            &lt;/includes&gt;\n            &lt;excludes&gt;\n                &lt;exclude&gt;liquibase/*.*&lt;/exclude&gt;\n            &lt;/excludes&gt;\n            &lt;outputDirectory&gt;unionvms-database-scripts&lt;/outputDirectory&gt;\n        &lt;/fileSet&gt;\n    &lt;/fileSets&gt;\n    &lt;files&gt;\n        &lt;file&gt;\n            &lt;source&gt;src/main/wf-scripts/uvms.properties&lt;/source&gt;\n            &lt;outputDirectory&gt;cli-scripts&lt;/outputDirectory&gt;\n            &lt;filtered&gt;true&lt;/filtered&gt;\n        &lt;/file&gt;\n    &lt;/files&gt;\n&lt;/assembly&gt;\n</code></pre> uvms.properties<pre><code>SERVER_CONFIG=standalone-full.xml\n# System properties\nusm_secretkey=\"${unionvms.usm.secret.key}\"\n# Naming\nasset_endpoint=http://localhost:8080/unionvms/asset/rest\nspatial_endpoint=http://localhost:8080/unionvms/spatial\nmovementrules_endpoint=http://localhost:8080/unionvms/movement-rules/rest\nexchange_endpoint=http://localhost:8080/unionvms/exchange/rest\nmovement_endpoint=http://localhost:8080/unionvms/movement/rest\nuser_endpoint=http://localhost:8080/unionvms/user/rest\nincident_endpoint=http://localhost:8080/unionvms/incident/rest\ncors_allowed_host_regex=.*\n# Datasource passwords\ndb_password_audit=${unionvms.database.audit.password}\ndb_password_movement=${unionvms.database.movement.password}\ndb_password_asset=${unionvms.database.asset.password}\ndb_password_exchange=${unionvms.database.exchange.password}\ndb_password_usm=${unionvms.database.usm.password}\ndb_password_spatial=${unionvms.database.spatial.password}\ndb_password_reporting=${unionvms.database.reporting.password}\ndb_password_movementrules=${unionvms.database.movement.rules.password}\ndb_password_incident=${unionvms.database.incident.password}\ndb_password_config=${unionvms.database.config.password}\ndb_password_activity=${unionvms.database.activity.password}\n</code></pre>"},{"location":"installation/manual/#install-and-start","title":"Install and Start","text":"<p>The following commands utilizes the <code>pom.xml</code> file above. There are a number of parameters that can either be set through environment variables or changed directly in <code>pom.xml</code>. The following examples opts for an environment variable approach since that lends itself for automation (think CI).</p> Environment variables<pre><code>tee -a uvms_environment_variables &lt;&lt; 'EOF'\nexport MAVEN_PROFILE_ENVIRONMENT=prod-server\nexport UMVS_VERSION=SET_ME\n\nexport UVMS_USM_SECRET_KEY=SET_ME\n\n# ssh credentials\nexport SERVER_USERNAME=SET_ME\nexport SERVER_PASSWORD=SET_ME\n\n# PostgreSQL (default: postgres/postgres)\nexport DB_USERNAME=SET_ME\nexport DB_PASSWORD=SET_ME\n\n# Wildfly management\nexport WF_MGMT_USERNAME=SET_ME\nexport WF_MGMT_PASSWORD=SET_ME\n\n# username / password for the PostgreSQL schemas\n# Match with what was set in the PostgreSQL setup\nexport ASSET_PASSWORD=SET_ME\nexport AUDIT_PASSWORD=SET_ME\nexport CONFIG_PASSWORD=SET_ME\nexport MOVEMENT_PASSWORD=SET_ME\nexport MOVEMENT_RULES_PASSWORD=SET_ME\nexport EXCHANGE_PASSWORD=SET_ME\nexport REPORTING_PASSWORD=SET_ME\nexport SPATIAL_PASSWORD=SET_ME\nexport USM_PASSWORD=SET_ME\nexport INCIDENT_PASSWORD=SET_ME\nexport ACTIVITY_PASSWORD=SET_ME\nEOF\n\nsource uvms_environment_variables\n</code></pre> Stop old instance and install<pre><code>mvn verify \\\n    -Pscp-stop-and-install-server,$MAVEN_PROFILE_ENVIRONMENT \\\n    -Dunionvms.docker.version=$UMVS_VERSION \\\n    -Dscp.target.server.username=$SERVER_USERNAME \\\n    -Dscp.target.server.password=$SERVER_PASSWORD \\\n    -Dunionvms.database.username=$DB_USERNAME \\\n    -Dunionvms.database.password=$DB_PASSWORD \\\n    -Dunionvms.database.asset.password=$ASSET_PASSWORD \\\n    -Dunionvms.database.audit.password=$AUDIT_PASSWORD \\\n    -Dunionvms.database.config.password=$CONFIG_PASSWORD \\\n    -Dunionvms.database.movement.password=$MOVEMENT_PASSWORD \\\n    -Dunionvms.database.movement.rules.password=$MOVEMENT_RULES_PASSWORD \\\n    -Dunionvms.database.exchange.password=$EXCHANGE_PASSWORD \\\n    -Dunionvms.database.reporting.password=$REPORTING_PASSWORD \\\n    -Dunionvms.database.spatial.password=$SPATIAL_PASSWORD \\\n    -Dunionvms.database.usm.password=$USM_PASSWORD \\\n    -Dunionvms.database.incident.password=$INCIDENT_PASSWORD \\\n    -Dunionvms.database.activity.password=$ACTIVITY_PASSWORD \\\n    -Dwildfly.mgmt.console.username=$WF_MGMT_USERNAME \\\n    -Dwildfly.mgmt.console.password=$WF_MGMT_PASSWORD \\\n    -Dunionvms.usm.secret.key=$UVMS_USM_SECRET_KEY \\\n    -U\n</code></pre> Update/Create database schema with Liquibase<pre><code>mvn liquibase:update \\\n    -Dliquibase.changeLogFile=target/liquibase/asset/liquibase/changelog/db-changelog-master.xml \\\n    -Dliquibase.defaultSchemaName=asset \\\n    -Dliquibase.username=asset \\\n    -Dliquibase.password=$ASSET_PASSWORD \\\n    -P$MAVEN_PROFILE_ENVIRONMENT\n\nmvn liquibase:update \\\n    -Dliquibase.changeLogFile=target/liquibase/audit/liquibase/changelog/db-changelog-master.xml \\\n    -Dliquibase.defaultSchemaName=audit \\\n    -Dliquibase.username=audit \\\n    -Dliquibase.password=$AUDIT_PASSWORD \\\n    -P$MAVEN_PROFILE_ENVIRONMENT\n\nmvn liquibase:update \\\n    -Dliquibase.changeLogFile=target/liquibase/config/liquibase/changelog/db-changelog-master.xml \\\n    -Dliquibase.defaultSchemaName=config \\\n    -Dliquibase.username=config \\\n    -Dliquibase.password=$CONFIG_PASSWORD \\\n    -P$MAVEN_PROFILE_ENVIRONMENT\n\nmvn liquibase:update \\\n    -Dliquibase.changeLogFile=target/liquibase/movement/liquibase/changelog/db-changelog-master-postgres.xml \\\n    -Dliquibase.defaultSchemaName=movement \\\n    -Dliquibase.username=movement \\\n    -Dliquibase.password=$MOVEMENT_PASSWORD \\\n    -P$MAVEN_PROFILE_ENVIRONMENT\n\nmvn liquibase:update \\\n    -Dliquibase.changeLogFile=target/liquibase/movement-rules/liquibase/changelog/db-changelog-master.xml \\\n    -Dliquibase.defaultSchemaName=movementrules \\\n    -Dliquibase.username=movementrules \\\n    -Dliquibase.password=$MOVEMENT_RULES_PASSWORD \\\n    -P$MAVEN_PROFILE_ENVIRONMENT\n\nmvn liquibase:update \\\n    -Dliquibase.changeLogFile=target/liquibase/exchange/liquibase/changelog/db-changelog-master.xml \\\n    -Dliquibase.defaultSchemaName=exchange \\\n    -Dliquibase.username=exchange \\\n    -Dliquibase.password=$EXCHANGE_PASSWORD \\\n    -P$MAVEN_PROFILE_ENVIRONMENT\n\nmvn liquibase:update \\\n    -Dliquibase.changeLogFile=target/liquibase/reporting/reporting-liquibase/changelog/db-changelog-master.xml \\\n    -Dliquibase.defaultSchemaName=reporting \\\n    -Dliquibase.username=reporting \\\n    -Dliquibase.password=$REPORTING_PASSWORD \\\n    -P$MAVEN_PROFILE_ENVIRONMENT\n\nmvn liquibase:update \\\n    -Dliquibase.changeLogFile=target/liquibase/spatial/liquibase/changelog/db-changelog-master.xml \\\n    -Dliquibase.defaultSchemaName=spatial \\\n    -Dliquibase.username=spatial \\\n    -Dliquibase.password=$SPATIAL_PASSWORD \\\n    -P$MAVEN_PROFILE_ENVIRONMENT\n\nmvn liquibase:update \\\n    -Dliquibase.changeLogFile=target/liquibase/user/liquibase/changelog/db-changelog-master.xml \\\n    -Dliquibase.defaultSchemaName=usm \\\n    -Dliquibase.username=usm \\\n    -Dliquibase.password=$USM_PASSWORD \\\n    -P$MAVEN_PROFILE_ENVIRONMENT\n\nmvn liquibase:update \\\n    -Dliquibase.changeLogFile=target/liquibase/incident/liquibase/changelog/db-changelog-master.xml \\\n    -Dliquibase.defaultSchemaName=incident \\\n    -Dliquibase.username=incident \\\n    -Dliquibase.password=$INCIDENT_PASSWORD \\\n    -P$MAVEN_PROFILE_ENVIRONMENT\n\nmvn liquibase:update \\\n    -Dliquibase.changeLogFile=target/liquibase/activity/liquibase/postgres/changelog/db-changelog-master.xml \\\n    -Dliquibase.defaultSchemaName=activity \\\n    -Dliquibase.username=activity \\\n    -Dliquibase.password=$ACTIVITY_PASSWORD \\\n    -P$MAVEN_PROFILE_ENVIRONMENT\n</code></pre> Start wildfly<pre><code>mvn clean install -Pscp-start-server,$MAVEN_PROFILE_ENVIRONMENT -Dscp.target.server.username=$SERVER_USERNAME -Dscp.target.server.password=$SERVER_PASSWORD -U\n</code></pre>"},{"location":"reference/","title":"Reference","text":"<p>Contains reference material for UVMS modules and plugins. The sections should cover what the module/plugin does and what configuration options are available.</p>"},{"location":"reference/asset/","title":"Asset","text":"<p>The asset module adds support for assets such as vessels and mobile terminals. The module is responsible for adding and updating incoming vessel information. There are three interfaces available; JMS, REST, and Java client (uses the REST interface). All three interfaces has support for updating, inserting, and querying.</p> <ul> <li> Asset Module</li> <li>:simple-sonarqube: Asset</li> </ul>"},{"location":"reference/asset/#artifacts","title":"Artifacts","text":""},{"location":"reference/asset/#asset-module","title":"Asset Module","text":"MavenGradle <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;fish.focus.uvms.asset&lt;/groupId&gt;\n    &lt;artifactId&gt;asset-module&lt;/artifactId&gt;\n    &lt;version&gt;6.8.35&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <pre><code>implementation 'fish.focus.uvms.asset:asset-module:6.8.35'\n</code></pre>"},{"location":"reference/asset/#asset-client","title":"Asset Client","text":"MavenGradle <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;fish.focus.uvms.asset&lt;/groupId&gt;\n    &lt;artifactId&gt;asset-client&lt;/artifactId&gt;\n    &lt;version&gt;6.8.35&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <pre><code>implementation 'fish.focus.uvms.asset:asset-client:6.8.35'\n</code></pre>"},{"location":"reference/asset/#jms-queues","title":"JMS queues","text":"Name JNDI Description UVMSAssetEvent java:/jms/queue/UVMSAssetEvent Request queue to Asset service module UVMSAsset java:/jms/queue/UVMSAsset Response queue to Asset module UVMSAuditEvent java:/jms/queue/UVMSAuditEvent Request queue to Audit service module UVMSUserEvent java:/jms/queue/UVMSUserEvent Request queue to User service module"},{"location":"reference/asset/#datasources","title":"Datasources","text":"Name JDNI <code>uvms_asset</code> <code>java:/jdbc/uvms_asset</code>"},{"location":"reference/audit/","title":"Audit","text":"<p>The purpose of the audit module is to store logs and events provided by other modules.</p> <ul> <li> Audit Module</li> <li>:simple-sonarqube: Audit</li> </ul>"},{"location":"reference/audit/#artifacts","title":"Artifacts","text":""},{"location":"reference/audit/#audit-module","title":"Audit Module","text":"MavenGradle <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;fish.focus.uvms.audit&lt;/groupId&gt;\n    &lt;artifactId&gt;audit-module&lt;/artifactId&gt;\n    &lt;version&gt;4.3.12&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <pre><code>implementation 'fish.focus.uvms.audit:audit-module:4.3.12'\n</code></pre>"},{"location":"reference/audit/#jms-queues","title":"JMS queues","text":"Name JNDI Description UVMSAudit java:/jms/queue/UVMSAudit Response queue to Audit module UVMSAuditEvent java:/jms/queue/UVMSAuditEvent Request queue to Audit module UVMSConfigEvent jms/queue/UVMSConfigEvent Request queue to send a Config message"},{"location":"reference/audit/#datasources","title":"Datasources","text":"Name JDNI <code>uvms_audit</code> <code>java:/jdbc/uvms_audit</code>"},{"location":"reference/config/","title":"Configuration","text":"<p>The Config module is the main repository for all application settings. It stores both global and module-specific settings, and allows access to them by the application, typically through a REST interface. Settings can be accessed all at once (as a catalog), only the ones associated with a certain module including global settings or individually.</p> <ul> <li> Config Module</li> <li>:simple-sonarqube: Config</li> </ul>"},{"location":"reference/config/#artifacts","title":"Artifacts","text":""},{"location":"reference/config/#config-module","title":"Config Module","text":"MavenGradle <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;fish.focus.uvms.config&lt;/groupId&gt;\n    &lt;artifactId&gt;config-module&lt;/artifactId&gt;\n    &lt;version&gt;4.3.12&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <pre><code>implementation 'fish.focus.uvms.config:config-module:4.3.12'\n</code></pre>"},{"location":"reference/config/#config-library","title":"Config library","text":"MavenGradle <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;fish.focus.uvms.lib&lt;/groupId&gt;\n    &lt;artifactId&gt;uvms-config&lt;/artifactId&gt;\n    &lt;version&gt;4.1.6&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <pre><code>implementation 'fish.focus.uvms.lib:uvms-config:4.1.6'\n</code></pre>"},{"location":"reference/config/#jms-queues","title":"JMS queues","text":"Name JNDI Description UVMSAuditEvent java:/jms/queue/UVMSAuditEvent Request queue to Audit module UVMSConfigEvent jms/queue/UVMSConfigEvent Request queue to Config module"},{"location":"reference/config/#datasources","title":"Datasources","text":"Name JDNI <code>uvms_config</code> <code>java:/jdbc/uvms_config</code>"},{"location":"reference/config/#global-settings","title":"Global Settings","text":"<p>Available in the GUI and encompasses settings that are not tied to a specific module.</p> <p>Warning</p> <p>Changes are applied directly without an explicit save step.</p>"},{"location":"reference/config/#configuration-options","title":"Configuration Options","text":"Name Default value Description Available languages English (GB) Note that only English (GB) is supported for now even though the dropdown has more options listed Coordinates format <code>DD MM,SS'</code> Changes between the two coordinate formats <code>DD MM,SS'</code> and <code>DD.MMM</code> Default home page Reporting Which \"tab\" should be opened when the old \"admin type of interface\" is opened Distance unit nautical miles Supports <code>nautical miles</code>, <code>kilometers</code>, and <code>miles</code> Long polling false Maximum speed (kts) 15 Numeric system metric Changes between metric and imperial numeric systems Speed unit knots Supports <code>knots</code>, <code>kilometers per hour</code>, and <code>miles per hour</code> Time format <code>YYYY-MM-DD HH:mm:ss</code> Changes between the two time formats <code>YYYY-MM-DD HH:mm:ss</code> and <code>YY/MM/DD HH:mm:ss</code> Timezone <code>+00:00</code> The timezone that the system is running in"},{"location":"reference/exchange/","title":"Exchange","text":"<p>The Exchange module facilitates data movement in and out of UVMS by defining one interface that plugins interact with. Plugin examples range from receiving AIS data to sending email.</p> <ul> <li> Exchange Module</li> <li>:simple-sonarqube: Exchange</li> </ul>"},{"location":"reference/exchange/#artifacts","title":"Artifacts","text":""},{"location":"reference/exchange/#exchange-module","title":"Exchange Module","text":"MavenGradle <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;fish.focus.uvms.exchange&lt;/groupId&gt;\n    &lt;artifactId&gt;exchange-module&lt;/artifactId&gt;\n    &lt;version&gt;5.3.32&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <pre><code>implementation 'fish.focus.uvms.exchange:exchange-module:5.3.32'\n</code></pre>"},{"location":"reference/exchange/#exchange-client","title":"Exchange Client","text":"MavenGradle <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;fish.focus.uvms.exchange&lt;/groupId&gt;\n    &lt;artifactId&gt;exchange-client&lt;/artifactId&gt;\n    &lt;version&gt;5.3.32&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <pre><code>implementation 'fish.focus.uvms.exchange:exchange-client:5.3.32'\n</code></pre>"},{"location":"reference/exchange/#jms-queues","title":"JMS queues","text":"Name JNDI Description UVMSMovementEvent java:/jms/queue/UVMSMovementEvent Request queue to Movement module UVMSExchange java:/jms/queue/UVMSExchange Response queue to Exchange module UVMSExchangeEvent java:/jms/queue/UVMSExchangeEvent Request queue to Exchange module"},{"location":"reference/exchange/#datasources","title":"Datasources","text":"Name JDNI <code>uvms_exchange</code> <code>java:/jdbc/uvms_exchange</code>"},{"location":"reference/incident/","title":"Incident","text":"<p>Responsible for events related to work flows for users, for example vessels that are not sending positions.</p> <ul> <li> Incident Module</li> <li>:simple-sonarqube: Incident</li> </ul>"},{"location":"reference/incident/#artifacts","title":"Artifacts","text":""},{"location":"reference/incident/#incident-module","title":"Incident Module","text":"MavenGradle <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;fish.focus.uvms.incident&lt;/groupId&gt;\n    &lt;artifactId&gt;incident-application&lt;/artifactId&gt;\n    &lt;version&gt;1.0.15&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <pre><code>implementation 'fish.focus.uvms.incident:incident-application:1.0.15'\n</code></pre>"},{"location":"reference/incident/#jms-queues","title":"JMS queues","text":"Name JNDI Description EventStream java:/jms/topic/EventStream Publishes an event on the topic IncidentEvent jms/queue/IncidentEvent Request queue to incident module"},{"location":"reference/incident/#datasources","title":"Datasources","text":"Name JDNI <code>uvms_incident</code> <code>java:/jdbc/uvms_incident</code>"},{"location":"reference/movement-rules/","title":"Movement Rules","text":"<p>Users can create customized rules that are then executed in the Movement Rules module. The rules can for example based on a position take a decision to forward it to an external party.</p> <ul> <li> Movement Rules Module</li> <li>:simple-sonarqube: Movement Rules</li> </ul>"},{"location":"reference/movement-rules/#artifacts","title":"Artifacts","text":""},{"location":"reference/movement-rules/#movement-rules-module","title":"Movement Rules Module","text":"MavenGradle <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;fish.focus.uvms.movement-rules&lt;/groupId&gt;\n    &lt;artifactId&gt;movement-rules-module&lt;/artifactId&gt;\n    &lt;version&gt;2.4.22&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <pre><code>implementation 'fish.focus.uvms.movement-rules:movement-rules-module:2.4.22'\n</code></pre>"},{"location":"reference/movement-rules/#jms-queues","title":"JMS queues","text":"Name JNDI Description UVMSMovement java:/jms/queue/UVMSMovement Response queue to Movement module UVMSMovementEvent java:/jms/queue/UVMSMovementEvent Request queue to Movement module UVMSExchangeEvent java:/jms/queue/UVMSExchangeEvent Request queue to Exchange module"},{"location":"reference/movement-rules/#datasources","title":"Datasources","text":"Name JDNI <code>uvms_movementrules</code> <code>java:/jdbc/uvms_movementrules</code>"},{"location":"reference/movement/","title":"Movement","text":"<p>The Movement modules area of responsibility is positions and movements of ships.</p> <ul> <li> Movement Module</li> <li>:simple-sonarqube: Movement</li> </ul>"},{"location":"reference/movement/#artifacts","title":"Artifacts","text":""},{"location":"reference/movement/#movement-module","title":"Movement Module","text":"MavenGradle <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;fish.focus.uvms.movement&lt;/groupId&gt;\n    &lt;artifactId&gt;movement-module&lt;/artifactId&gt;\n    &lt;version&gt;5.6.21&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <pre><code>implementation 'fish.focus.uvms.movement:movement-module:5.6.21'\n</code></pre>"},{"location":"reference/movement/#movement-client","title":"Movement Client","text":"MavenGradle <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;fish.focus.uvms.movement&lt;/groupId&gt;\n    &lt;artifactId&gt;movement-client&lt;/artifactId&gt;\n    &lt;version&gt;5.6.21&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <pre><code>implementation 'fish.focus.uvms.movement:movement-client:5.6.21'\n</code></pre>"},{"location":"reference/movement/#jms-queues","title":"JMS queues","text":"Name JNDI Description UVMSMovement java:/jms/queue/UVMSMovement Response queue to Movement module UVMSMovementEvent java:/jms/queue/UVMSMovementEvent Request queue to Movement module UVMSExchangeEvent java:/jms/queue/UVMSExchangeEvent Request queue to Exchange module"},{"location":"reference/movement/#datasources","title":"Datasources","text":"Name JDNI <code>uvms_movement</code> <code>java:/jdbc/uvms_movement</code>"},{"location":"reference/spatial/","title":"Spatial","text":"<p>Performs area calculations for incoming vessel positions.</p> <ul> <li> Spatial Module</li> <li>:simple-sonarqube: Spatial</li> </ul>"},{"location":"reference/spatial/#artifacts","title":"Artifacts","text":""},{"location":"reference/spatial/#spatial-module","title":"Spatial Module","text":"MavenGradle <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;fish.focus.uvms.spatial&lt;/groupId&gt;\n    &lt;artifactId&gt;spatial-module&lt;/artifactId&gt;\n    &lt;version&gt;2.2.12&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <pre><code>implementation 'fish.focus.uvms.spatial:spatial-module:2.2.12'\n</code></pre>"},{"location":"reference/spatial/#spatial-client","title":"Spatial Client","text":"MavenGradle <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;fish.focus.uvms.spatial&lt;/groupId&gt;\n    &lt;artifactId&gt;spatial-client&lt;/artifactId&gt;\n    &lt;version&gt;2.2.12&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <pre><code>implementation 'fish.focus.uvms.spatial:spatial-client:2.2.12'\n</code></pre>"},{"location":"reference/spatial/#jms-queues","title":"JMS queues","text":"Name JNDI Description UVMSSpatial java:/jms/queue/UVMSSpatial Response queue to Spatial module UVMSSpatialEvent java:/jms/queue/UVMSSpatialEvent Request queue to Spatial service module UVMSConfigEvent java:/jms/queue/UVMSConfigEvent Request queue to Config service module"},{"location":"reference/spatial/#datasources","title":"Datasources","text":"Name JDNI <code>uvms_spatial</code> <code>java:/jdbc/uvms_spatial</code>"},{"location":"reference/web-gateway/","title":"Web Gateway","text":"<p>API that combines information from several sources, if needed. For example, viewing an incident in the GUI requires more information than just the incident, the web gateway will then fetch notes, positions, and poll logs that are related to the incident.</p> <ul> <li> Web Gateway Module</li> <li>:simple-sonarqube: Web Gateway</li> </ul>"},{"location":"reference/web-gateway/#artifacts","title":"Artifacts","text":""},{"location":"reference/web-gateway/#web-gateway-module","title":"Web Gateway Module","text":"MavenGradle <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;fish.focus.uvms.web-gateway&lt;/groupId&gt;\n    &lt;artifactId&gt;web-gateway&lt;/artifactId&gt;\n    &lt;version&gt;1.0.9&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <pre><code>implementation 'fish.focus.uvms.web-gateway:web-gateway:1.0.9'\n</code></pre>"},{"location":"reference/web-gateway/#jms-queues","title":"JMS queues","text":"Name JNDI Description EventStream java:/jms/topic/EventStream Listens for events on the topic and publishes them on an SSE stream"},{"location":"topics/","title":"Topics","text":"<p>The following sections contains a deep dive into the inner workings of UVMS. For example, the topic assets discusses how merging information from several sources is done within UVMS.</p>"},{"location":"topics/assets/","title":"Assets","text":"<p>Up-to-date asset information is vital to the function of UVMS. To facilitate adding &amp; updating asset information there are several interfaces available, see asset reference section.</p> <p>Historically there have been many attempts at a unique vessel ID, with one of the main problems being adoption. Vessels typically have many different types of IDs connected to them. A vessel within the EU might have a national ID, CFR, MMSI, IRCS, and more.</p> <p>In order to determine if a new asset should be created or not UVMS uses the following list of IDs to identify a vessel:</p> <ol> <li>IMO</li> <li>CFR</li> <li>National ID</li> <li>IRCS</li> <li>MMSI</li> </ol> <p>Note that roughly speaking, the three first IDs (IMO, CFR, and National ID) are tied to the vessel while the two last ones (IRCS and MMSI) are tied to the owner / sending equipment.</p>"},{"location":"topics/assets/#deeper-dive-into-ids","title":"Deeper dive into IDs","text":"<p>Even with this list of IDs there are quite some nuances that need to be taken into account. Attaching more details to each ID on its lifetime starts to give a clearer picture of problems that might arise when adding / updating assets.</p> <ol> <li>IMO: unique - follows vessel</li> <li>CFR: unique - follows vessel while inside EU</li> <li>National ID: unique per country - follows vessel inside country</li> <li>IRCS: should be unique (per country) but reuse has happened in the past,    might not follow vessel when sold</li> <li>MMSI: unique (per country), follows the owner and not the vessel, but might    be taken over by new owner</li> </ol> <p>The reason for including IRCS and MMSI in this list is that they are used for finding assets that might have been added through e.g. an AIS static report, or finding existing assets in the AIS movement flow (only IRCS and MMSI are sent).</p> <p>UVMS versions prior to 4.6.0 had all of the IDs set as globally unique which meant that importing/exporting/renting vessels became troublesome. Later versions (&gt;=4.6.0) loosened those restrictions somewhat. For example, National ID and IRCS are now unique per country and not globally unique. In addition, UVMS now allow several inactive vessels with the same IRCS/MMSI, but only one active to account for the \"reuse has happened in the past even though it's not supposed to happen\" scenarios.</p>"},{"location":"topics/assets/#flows","title":"Flows","text":"<p>Having looked at which IDs have been chosen for UVMS a natural follow up question is</p> <p>When is an asset created / updated?</p> <p>There are several asset flows within UVMS, chief of which is a \"national source\" of asset data, but also incoming positions and static reports. The \"national source\" should be considered the main data source and all other flows are there to shore up any missed data.</p> National Source module <p>Due to its nature, a \"national source\" component is not supplied by UVMS since it directly fetches data from an internal vessel source that differs in all installations. Typically that functionality is implemented as a module that utilizes the asset JMS interface (<code>jms/queue/UVMSAssetEvent</code>).</p> <p>A simplified version of the default create / update flow is as follows:</p> <pre><code>---\ntitle: The \"national source\" create/update asset flow\n---\nsequenceDiagram\n    autonumber\n    participant ns as \"National source\" module\n    participant a as Asset module\n\n    ns-&gt;&gt;a: Upsert asset\n    a-&gt;&gt;Database: Look for existing assets\n    Database--&gt;&gt;a: No asset found&lt;br&gt;or existing asset found\n    a-&gt;&gt;Database: Create new asset&lt;br&gt;or update existing asset\n    Database--&gt;&gt;a: Created / Updated\n    a--&gt;&gt;ns: Ok</code></pre> <p>Note that step 2 tries to use all of the IDs listed above, specifically utilizing the default ID set in the upsert asset request. Typically that would be set to CFR for within the EU. This create / update flow covers most cases, however there are edge cases that needs to be taken into account, see section Scenarios for such edge cases.</p>"},{"location":"topics/assets/#scenarios","title":"Scenarios","text":"<p>The following subchapters detail what happens in a few select scenarios.</p>"},{"location":"topics/assets/#ais-positions-before-national-source-sync","title":"AIS positions before \"national source\" sync","text":"<p>What happens if a vessel starts sending AIS positions before the national source has been updated or synced?</p> <p>In UVMS the following happens:</p> <pre><code>---\ntitle: AIS movement flow\n---\nsequenceDiagram\n    autonumber\n    AIS module-&gt;&gt;Movement module: Incoming AIS position\n    Movement module-&gt;&gt;Asset module: Collect Asset &amp;&lt;br&gt;Mobile Terminal\n    Asset module-&gt;&gt;Database: Create new unknown asset since&lt;br&gt;MMSI/IRCS doesn't exist in database\n    Database--&gt;&gt;Asset module: Created\n    Asset module--&gt;&gt;Movement module: Return created asset\n    Movement module-&gt;&gt;Movement module: Continue processing&lt;br&gt;incoming movement</code></pre> <p>In step 3 UVMS creates a new \"unknown\" asset that does not contain much information since all the AIS position carries is MMSI/IRCS. Neither of which is present in the database yet. When next an update from the \"national source\" comes into the system there are three separate pieces of data that need to be reconciled; the incoming data, the \"old\" asset, and the unknown asset that was created in the step above.</p> <pre><code>---\ntitle: Update from \"national source\" with already present unknown asset from AIS flow\n---\nsequenceDiagram\n    autonumber\n    participant ns as \"National source\" module\n    participant a as Asset module\n    participant d as Database\n    participant m as Movement module\n\n    ns-&gt;&gt;a: Upsert asset\n    a-&gt;&gt;d: Look for existing assets\n    d--&gt;&gt;a: Multiple existing assets found\n    a-&gt;&gt;d: Merge all asset information into one entry\n    d--&gt;&gt;a: Updated\n    a-&gt;&gt;m: Asset merged event\n    m-&gt;&gt;d: Remap movements and movement connect\n    d--&gt;&gt;m: Updated\n    m--&gt;&gt;a: Ok\n    a--&gt;&gt;ns: Ok</code></pre> <p>Another way to look at it is from the data point of view. The following flowchart shows what it looks like after the \"Unknown\" asset was created and just before any processing of the \"national source\" update has happened.</p> <pre><code>---\ntitle: Update from \"national source\" with already present unknown asset from AIS flow\n---\nflowchart TD\n    classDef default fill:#e9eded84,stroke:#38664184,stroke-width:1px,text-align: left;\n    classDef dotted stroke-width:1px,stroke-dasharray: 5 5;\n    classDef green fill:#83994f;\n\n    subgraph outcome [After]\n        inc[\" \"]:::dotted --&gt; DB[(Asset)]\n        DB -.-&gt; A[\"`Asset\n        {\n        cfr: SWE00...\n        imo: 992...\n        nationalId: 193...\n        name: **abc**\n        ircs: **SFB-9876**\n        mmsi: **2561234**\n        active: **true**\n        ...\n        }`\"]:::green\n        DB -.-&gt; B[\" \"]:::dotted\n    end\n\n    subgraph before [Before]\n        sinc[\"`Asset\n        {\n        cfr: SWE00...\n        imo: 992...\n        nationalId: 193...\n        name: **abc**\n        ircs: **SFB-9876**\n        mmsi: **2561234**\n        active: **true**\n        ...\n        }`\"]:::green --&gt; sDB[(Asset)]\n\n        sDB -.-&gt; sB[\"`Asset\n        {\n        cfr: SWE00...\n        imo: 992...\n        nationalId: 193...\n        name: **abc**\n        ircs: **SFB-1234**\n        mmsi: **2560987**\n        active: **true**\n        ...\n        }`\"]\n        sDB -.-&gt; sA[\"`Asset\n        {\n        cfr: null\n        imo: null\n        nationalId: null\n        name: **Unknown-1234**\n        ircs: **SFB-9876**\n        mmsi: **2561234**\n        active: **true**\n        ...\n        }`\"]\n\n    end</code></pre> <p>As can be seen in the flowchart above, the two assets already in the database don't have any IDs in common. It's not until the \"national source\" update comes in that a conflict arises that needs sorting out. As mentioned already, the conflict is solved by merging the three entities and remapping any positions tied to the \"Unknown\" asset to the asset from \"national source\".</p>"},{"location":"topics/assets/#sale-from-eu-country-to-non-eu-country-and-back","title":"Sale from EU country to non-EU country and back","text":"<p>What happens when a vessel is sold from a EU country to a non-EU country? What happens if it's then sold back to the origin country?</p> <p>When a vessel is sold outside of the EU, only IMO is kept (if it has one). From UVMS point of view, if the vessel does not have IMO then there are no in common IDs that can be used in order to maintain history across borders. In essence, once exported, the vessel is a completely new vessel and the old one should be set to inactive at the \"national source\" that is then synced to UVMS.</p> <p>If the vessel is then sold back to the origin country, it might retain the old IDs from before the export. At least CFR (and IMO) should be the same as before the export. That means, the old entry from before the export can now be updated and history for the vessel continues.</p>"},{"location":"topics/assets/#seasonal-rental-from-other-eu-country","title":"Seasonal rental from other EU country","text":"<p>What happens if a vessel is rented out to another company in another EU country?</p> <p>When staying within the EU, CFR is kept which means that updates to e.g. IRCS and MMSI is done directly to the original vessel (as well as changing the nation that it's registered under).</p> <p>If updates to the \"national source\" is slow the AIS position scenario might occur.</p>"},{"location":"topics/assets/#vms-positions-and-ids","title":"VMS positions and IDs","text":"<p>How are IDs related to VMS positions?</p> <p>VMS positions do not directly interact with the above mentioned IDs. Instead VMS positions map positions to assets through DNID and member number, i.e. channel -&gt; mobile terminal -&gt; asset. This means that, for positions to be assigned to the correct asset, mobile terminal and channels need to be correctly configured for the assets.</p>"}]}